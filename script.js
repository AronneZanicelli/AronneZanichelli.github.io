const translations = {
  en: {
    nav: { about: 'About', skills: 'Skills', timeline: 'Education', portfolio: 'Portfolio', editing: 'Editing', contact: 'Contact' },
    hero: {
      positioning: 'Junior Developer with creative and AI-oriented skills.',
      subtitle:
        'I build practical digital experiences by combining development fundamentals, visual communication, and strategic content thinking.',
      ctaProjects: 'View Projects',
      ctaCv: 'Download CV',
      ctaContact: 'Contact'
    },
    about: {
      title: 'About Me',
      bio:
        'I am Aronne Zanichelli, an IT graduate in Computer Science and Telecommunications. I grew up with technology and I enjoy turning digital passion into real, useful work. My profile blends development fundamentals with visual communication and social content execution.',
      goalTitle: 'Professional Goal',
      goalText:
        'I want to enter the world of video games and interactive technologies, including VR-oriented experiences. I am looking for junior opportunities in web/game development where I can combine programming, creativity, and fast learning.',
      valueTitle: 'What I bring to a team',
      valueOne: 'Technical + creative mindset: code with attention to communication and UX.',
      valueTwo: 'Operational autonomy in execution and delivery.',
      valueThree: 'Problem-solving attitude and strong motivation for junior growth paths.'
    },
    availability: {
      title: 'Availability',
      text: 'Based in Italy (Europe/Rome timezone). Open to junior opportunities, internships, and collaborative projects in web development or game development, with remote or hybrid setup. Driving license B and own vehicle.'
    },
    skills: {
      title: 'Technical Skills',
      html: 'HTML and CSS for responsive interfaces (solid foundations)',
      java: 'Java for object-oriented projects',
      cpp: 'C++ foundations for logic and performance',
      python: 'Python (beginner level, currently building fundamentals)',
      sql: 'SQL and relational database fundamentals',
      creative: 'DaVinci Resolve, Office Suite, Adobe Suite (basic/intermediate)'
    },
    softSkills: {
      title: 'Soft Skills',
      one: 'Problem solving',
      two: 'Fast learning mindset',
      three: 'Teamwork and communication',
      four: 'Creative discipline and reliability'
    },
    languages: {
      title: 'Languages',
      it: 'Italian — Native',
      en: 'English — Intermediate (B2)',
      es: 'Spanish — Basic (A1)'
    },
    timeline: {
      title: 'Education & Experience',
      educationTitle: 'IT Diploma (2019-2025) - Istituto Superiore Statale S. D\'Arzo',
      educationDesc: 'Technical diploma in computer science and telecommunications.',
      conadTitle: 'Cashier / Warehouse Assistant - Conad (May 2021 - Sep 2021)',
      conadDesc: 'Managed cashier operations, shelf restocking, and warehouse organization with operational autonomy.',
      sinegoTitle: 'Public Relations Assistant - Sinego Srl (Sep 2021 - Aug 2022)',
      sinegoDesc: 'Front-facing communication support and relationship management in customer-facing activities.',
      optimaTitle: 'Commercial Consultant - Optima Spa (May 2024 - Jul 2025)',
      optimaDesc: 'Consulting for telecom services targeted to both private clients and businesses.',
      currentTitle: 'Current - IFTS Graphic Technician & AI-based Social Media Manager',
      currentDesc: 'Training path combining visual design, media strategy, and AI-oriented digital workflows.'
    },
    portfolio: {
      title: 'Portfolio',
      project1Title: 'Web Landing Page for Tech Profile',
      project1Desc:
        'Designed and built a responsive personal landing page focused on clear value proposition, bilingual content, and recruiter-ready structure.',
      project2Title: 'Visual Content Workflow Concept',
      project2Desc:
        'Created a production workflow concept integrating copy, graphics, and short video editing using DaVinci Resolve and Adobe tools.',
      inProgressTitle: 'Projects in Development',
      inProgressDesc:
        'Dependency Monitoring App: concept and implementation of a lightweight app to track package dependencies, detect outdated modules, and improve project maintenance visibility.',
      featuredTitle: 'Featured Projects (Building Block)',
      featuredIntro: 'This section is ready to grow with concrete projects and measurable outcomes.',
      featuredOne: 'Project 01 template: Problem → Solution → Stack → Result → Repo/Live link.',
      featuredTwo: 'Project 02 template: production workflow + before/after impact.',
      featuredThree: 'Project 03 template: game/web prototype with short demo and learnings.'
    },
    cv: {
      title: 'Download CV',
      description: 'Download English or Italian CV in PDF, or use print mode to generate a tailored version directly from this site.',
      downloadEn: 'Download CV (EN)',
      downloadIt: 'Download CV (IT)',
      print: 'Print / Save as PDF'
    },
    contact: {
      title: 'Contact',
      formName: 'Name',
      formEmail: 'Email',
      formMessage: 'Message',
      send: 'Send message',
      success: 'Thanks! Your message was sent successfully.',
      error: 'Please complete all fields with a valid email.',
      integrationTitle: 'Form integration snippets'
    },
    footer: { language: 'Language: English' }
  },
  it: {
    nav: { about: 'Chi sono', skills: 'Competenze', timeline: 'Formazione', portfolio: 'Portfolio', editing: 'Editing', contact: 'Contatti' },
    hero: {
      positioning: 'Junior Developer con competenze creative e AI-oriented.',
      subtitle:
        'Realizzo esperienze digitali pratiche unendo basi di sviluppo, comunicazione visiva e pensiero strategico sui contenuti.',
      ctaProjects: 'Vedi progetti',
      ctaCv: 'Scarica CV',
      ctaContact: 'Contattami'
    },
    about: {
      title: 'Chi sono',
      bio:
        'Sono Aronne Zanichelli, diplomato in Informatica e Telecomunicazioni. Sono cresciuto con la tecnologia e mi piace trasformare la passione digitale in lavoro reale e utile. Il mio profilo unisce basi di sviluppo, comunicazione visiva e produzione contenuti social.',
      goalTitle: 'Obiettivo professionale',
      goalText:
        'Voglio entrare nel mondo dei videogiochi e delle tecnologie interattive, con una visione che include anche la realtà virtuale. Cerco opportunità junior in web/game development dove unire programmazione, creatività e crescita rapida.',
      valueTitle: 'Cosa porto in un team',
      valueOne: 'Mentalità tecnica + creativa: codice con attenzione a comunicazione e UX.',
      valueTwo: 'Autonomia operativa nell\'esecuzione e nella consegna.',
      valueThree: 'Approccio al problem solving e forte motivazione in percorsi junior.'
    },
    availability: {
      title: 'Disponibilità',
      text: 'Base in Italia (fuso Europe/Rome). Disponibile per opportunità junior, stage e collaborazioni in web development o game development, in remoto o ibrido. Patente B e automunito.'
    },
    skills: {
      title: 'Competenze tecniche',
      html: 'HTML e CSS per interfacce responsive (basi solide)',
      java: 'Java per progetti orientati agli oggetti',
      cpp: 'Basi di C++ per logica e performance',
      python: 'Python (livello iniziale, sto consolidando i fondamentali)',
      sql: 'SQL e fondamenti di database relazionali',
      creative: 'DaVinci Resolve, Pacchetto Office, Pacchetto Adobe (base/intermedio)'
    },
    softSkills: {
      title: 'Soft Skills',
      one: 'Problem solving',
      two: 'Apprendimento rapido',
      three: 'Teamwork e comunicazione',
      four: 'Disciplina creativa e affidabilità'
    },
    languages: {
      title: 'Lingue',
      it: 'Italiano — Madrelingua',
      en: 'Inglese — Intermedio (B2)',
      es: 'Spagnolo — Base (A1)'
    },
    timeline: {
      title: 'Formazione ed esperienza',
      educationTitle: 'Diploma IT (2019-2025) - Istituto Superiore Statale S. D\'Arzo',
      educationDesc: 'Diploma tecnico in Informatica e Telecomunicazioni.',
      conadTitle: 'Cassiere / Magazziniere - Conad (Mag 2021 - Set 2021)',
      conadDesc: 'Gestione cassa, rifornimento scaffali e organizzazione magazzino in autonomia.',
      sinegoTitle: 'Addetto alle Pubbliche Relazioni - Sinego Srl (Set 2021 - Ago 2022)',
      sinegoDesc: 'Supporto nella comunicazione front-facing e gestione relazionale con il pubblico.',
      optimaTitle: 'Consulente Commerciale - Optima Spa (Mag 2024 - Lug 2025)',
      optimaDesc: 'Consulenza su servizi di telecomunicazione rivolta ad aziende e privati.',
      currentTitle: 'Attualmente - IFTS Tecnico Grafico & Social Media Manager AI-based',
      currentDesc: 'Percorso che integra design visivo, strategia media e workflow digitali orientati all\'AI.'
    },
    portfolio: {
      title: 'Portfolio',
      project1Title: 'Landing Page Web per profilo tech',
      project1Desc:
        'Progettazione e sviluppo di una landing page personale responsive con posizionamento chiaro, contenuti bilingue e struttura orientata ai recruiter.',
      project2Title: 'Concept workflow per contenuti visual',
      project2Desc:
        'Creazione di un concept di produzione che integra copy, grafica ed editing video breve usando DaVinci Resolve e strumenti Adobe.',
      inProgressTitle: 'Progetti in sviluppo',
      inProgressDesc:
        'App di monitoraggio delle dipendenze: progettazione e sviluppo di una app leggera per tracciare dipendenze, individuare moduli obsoleti e migliorare la visibilità sulla manutenzione.',
      featuredTitle: 'Featured Projects (base pronta)',
      featuredIntro: 'Questa sezione è pronta per crescere con progetti concreti e risultati misurabili.',
      featuredOne: 'Template progetto 01: Problema → Soluzione → Stack → Risultato → Link repo/live.',
      featuredTwo: 'Template progetto 02: workflow produzione + impatto prima/dopo.',
      featuredThree: 'Template progetto 03: prototipo game/web con demo breve e learnings.'
    },
    cv: {
      title: 'Download CV',
      description: 'Scarica il CV in PDF in inglese o italiano, oppure usa la stampa per generare una versione personalizzata direttamente dal sito.',
      downloadEn: 'Scarica CV (EN)',
      downloadIt: 'Scarica CV (IT)',
      print: 'Stampa / Salva PDF'
    },
    contact: {
      title: 'Contatti',
      formName: 'Nome',
      formEmail: 'Email',
      formMessage: 'Messaggio',
      send: 'Invia messaggio',
      success: 'Grazie! Il messaggio è stato inviato con successo.',
      error: 'Compila tutti i campi con una email valida.',
      integrationTitle: 'Snippet integrazione form'
    },
    footer: { language: 'Lingua: Italiano' }
  }
};

const getValueByPath = (obj, path) => path.split('.').reduce((acc, key) => acc?.[key], obj);

function applyLanguage(lang) {
  const safeLang = translations[lang] ? lang : 'en';
  document.documentElement.lang = safeLang;
  localStorage.setItem('lang', safeLang);

  document.querySelectorAll('[data-i18n]').forEach((el) => {
    const key = el.getAttribute('data-i18n');
    const value = getValueByPath(translations[safeLang], key);
    if (value) el.textContent = value;
  });

  document.querySelectorAll('.lang-btn').forEach((btn) => {
    btn.classList.toggle('active', btn.dataset.lang === safeLang);
  });
}

function setupTheme() {
  const savedTheme = localStorage.getItem('theme') || 'dark';
  document.body.classList.toggle('light', savedTheme === 'light');
  document.getElementById('themeToggle').textContent = savedTheme === 'light' ? '☀︎' : '☾';

  document.getElementById('themeToggle').addEventListener('click', () => {
    const isLight = document.body.classList.toggle('light');
    localStorage.setItem('theme', isLight ? 'light' : 'dark');
    document.getElementById('themeToggle').textContent = isLight ? '☀︎' : '☾';
  });
}

function setupMenu() {
  const toggle = document.getElementById('menuToggle');
  const menu = document.getElementById('navMenu');
  toggle.addEventListener('click', () => {
    const open = menu.classList.toggle('open');
    toggle.setAttribute('aria-expanded', String(open));
  });
}

function setupContactForm() {
  const form = document.getElementById('contactForm');
  const feedback = document.getElementById('formFeedback');

  form.addEventListener('submit', async (event) => {
    event.preventDefault();
    const lang = localStorage.getItem('lang') || 'en';

    const name = form.name.value.trim();
    const email = form.email.value.trim();
    const message = form.message.value.trim();
    const emailValid = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);

    if (!name || !emailValid || !message) {
      feedback.textContent = translations[lang].contact.error;
      return;
    }

    try {
      const response = await fetch(form.action, {
        method: 'POST',
        headers: { Accept: 'application/json' },
        body: new FormData(form)
      });

      if (response.ok) {
        if (typeof window.gtag === 'function') {
          window.gtag('event', 'submit_contact_form_success');
        }
        feedback.textContent = translations[lang].contact.success;
        form.reset();
      } else {
        if (typeof window.gtag === 'function') {
          window.gtag('event', 'submit_contact_form_error');
        }
        feedback.textContent = translations[lang].contact.error;
      }
    } catch {
      feedback.textContent = translations[lang].contact.error;
    }
  });
}

function setupAnalyticsEvents() {
  const track = (eventName, params = {}) => {
    if (typeof window.gtag === 'function') {
      window.gtag('event', eventName, params);
    }
  };

  document.getElementById('viewProjectsCta')?.addEventListener('click', () => {
    track('click_cta', { cta: 'view_projects' });
  });

  document.getElementById('downloadCvEn')?.addEventListener('click', () => {
    track('download_cv', { language: 'en' });
  });

  document.getElementById('downloadCvIt')?.addEventListener('click', () => {
    track('download_cv', { language: 'it' });
  });

  document.getElementById('printCv')?.addEventListener('click', () => {
    track('print_cv');
  });

  document.getElementById('linkedinLink')?.addEventListener('click', () => {
    track('click_social', { platform: 'linkedin' });
  });

  document.getElementById('githubLink')?.addEventListener('click', () => {
    track('click_social', { platform: 'github' });
  });

  document.getElementById('emailLink')?.addEventListener('click', () => {
    track('click_email');
  });

  document.querySelectorAll('.lang-btn').forEach((btn) => {
    btn.addEventListener('click', () => {
      track('switch_language', { language: btn.dataset.lang });
    });
  });

  let scroll50Tracked = false;
  let scroll90Tracked = false;
  window.addEventListener('scroll', () => {
    const pageHeight = document.documentElement.scrollHeight - window.innerHeight;
    if (pageHeight <= 0) return;
    const progress = (window.scrollY / pageHeight) * 100;

    if (!scroll50Tracked && progress >= 50) {
      scroll50Tracked = true;
      track('scroll_depth', { percent: 50 });
    }

    if (!scroll90Tracked && progress >= 90) {
      scroll90Tracked = true;
      track('scroll_depth', { percent: 90 });
    }
  });

  setTimeout(() => track('engaged_time', { seconds: 30 }), 30000);
  setTimeout(() => track('engaged_time', { seconds: 90 }), 90000);

  document.getElementById('contactForm')?.addEventListener('submit', () => {
    track('submit_contact_form_attempt');
  });
}

function init() {
  const preferredLang = localStorage.getItem('lang') || 'en';
  applyLanguage(preferredLang);

  document.querySelectorAll('.lang-btn').forEach((btn) => {
    btn.addEventListener('click', () => applyLanguage(btn.dataset.lang));
  });

  setupTheme();
  setupMenu();
  setupContactForm();
  setupAnalyticsEvents();

  document.getElementById('printCv')?.addEventListener('click', () => window.print());
  const yearEl = document.getElementById('year');
  if (yearEl) yearEl.textContent = new Date().getFullYear();
}

document.addEventListener('DOMContentLoaded', init);
